{
	"$defs": {
		"timestamp": {"type": "string"},
		"callsign": {"type": "string"},
		"action": {"type": "string", "enum": ["linking", "unlinked", "failed", "relinking"]},
		"protocol": {"type": "string", "enum": ["d-plus", "dextra", "dcs", "ccs"]},
		"direction": {"type": "string", "enum": ["in", "out"]},
		"reason": {"type": "string", "enum": ["user", "timer", "network"]}
	},

	"status": {
		"type": "object",
		"timestamp": {"$ref": "#/$defs/timestamp"},
		"message": {"type": "string"},
		"required": ["timestamp", "message"]
	},
	
	"link": {
		"type": "object",
		"timestamp": {"$ref": "#/$defs/timestamp"},
		"action": {"$ref": "#/$defs/action"},
		"reason": {"$ref": "#/$defs/reason"},
		"local": {"$ref": "#/defs/callsign"},
		"remote": {"$ref": "#/defs/callsign"},
		"direction": {"$ref": "#/defs/direction"},
		"protocol": {"$ref": "#/defs/protocol"},
		"required": ["timestamp", "protocol", "action", "local", "remote"]
	}
}

